{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/sahil/fertigo_web/app/main/Map/MapPickerModal.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { GeoSearchControl, OpenStreetMapProvider } from \"leaflet-geosearch\";\r\nimport { useEffect } from \"react\";\r\nimport { MapContainer, TileLayer, Marker, useMapEvents } from \"react-leaflet\";\r\nimport { useState } from \"react\";\r\nimport L from \"leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport \"leaflet-geosearch/dist/geosearch.css\";\r\n\r\ninterface Props {\r\n    initialLat: number | null;\r\n    initialLng: number | null;\r\n    onSelect: (lat: number, lng: number) => void;\r\n    onClose: () => void;\r\n}\r\n\r\n/* Fix default marker icon */\r\ndelete (L.Icon.Default.prototype as any)._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n    iconRetinaUrl:\r\n        \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png\",\r\n    iconUrl:\r\n        \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png\",\r\n    shadowUrl:\r\n        \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png\",\r\n});\r\n\r\nexport default function MapPickerModal({\r\n    initialLat,\r\n    initialLng,\r\n    onSelect,\r\n    onClose,\r\n}: Props) {\r\n    const [position, setPosition] = useState<[number, number] | null>(\r\n        initialLat !== null && initialLng !== null\r\n            ? [initialLat, initialLng]\r\n            : null\r\n    );\r\n\r\n    function LocationMarker() {\r\n        useMapEvents({\r\n            click(e) {\r\n                const { lat, lng } = e.latlng;\r\n                setPosition([lat, lng]);\r\n            },\r\n        });\r\n\r\n        return position ? <Marker position={position} /> : null;\r\n    }\r\n\r\n    function SearchControl({\r\n        onSelect,\r\n    }: {\r\n        onSelect: (lat: number, lng: number) => void;\r\n    }) {\r\n        const map = useMapEvents({});\r\n\r\n        useEffect(() => {\r\n            const provider = new OpenStreetMapProvider();\r\n\r\n            const searchControl = new (GeoSearchControl as any)({\r\n                provider,\r\n                style: \"bar\",\r\n                showMarker: false,\r\n                autoClose: true,\r\n                retainZoomLevel: false,\r\n                searchLabel: \"Search location...\",\r\n            });\r\n\r\n            map.addControl(searchControl);\r\n\r\n            map.on(\"geosearch/showlocation\", (result: any) => {\r\n                const { x, y } = result.location; // lng, lat\r\n                onSelect(y, x);\r\n                map.setView([y, x], 15);\r\n            });\r\n\r\n            return () => {\r\n                map.removeControl(searchControl);\r\n            };\r\n        }, [map, onSelect]);\r\n\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center\">\r\n            <div className=\"bg-white rounded-xl w-[90%] max-w-3xl overflow-hidden\">\r\n                <div className=\"flex justify-between items-center px-4 py-3 border-b\">\r\n                    <h3 className=\"font-bold\">Select Location</h3>\r\n                    <button onClick={onClose} className=\"text-sm text-gray-500\">\r\n                        Cancel\r\n                    </button>\r\n                </div>\r\n\r\n                <MapContainer\r\n                    center={position ?? [20.5937, 78.9629]}\r\n                    zoom={position ? 15 : 5}\r\n                    style={{ height: \"400px\", width: \"100%\" }}\r\n                >\r\n                    <TileLayer\r\n                        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                    />\r\n\r\n                    {/* üîç Search */}\r\n                    <SearchControl\r\n                        onSelect={(lat, lng) => {\r\n                            setPosition([lat, lng]);\r\n                        }}\r\n                    />\r\n\r\n                    {/* üìç Click marker */}\r\n                    <LocationMarker />\r\n                </MapContainer>\r\n\r\n                <div className=\"flex justify-end gap-3 p-4 border-t\">\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"px-4 py-2 rounded-lg border\"\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                    <button\r\n                        disabled={!position}\r\n                        onClick={() => {\r\n                            if (position) onSelect(position[0], position[1]);\r\n                        }}\r\n                        className=\"px-4 py-2 rounded-lg bg-pink-600 text-white disabled:opacity-50\"\r\n                    >\r\n                        Confirm Location\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;;;AANA;;;;;;;;AAiBA,2BAA2B,GAC3B,OAAO,AAAC,uLAAC,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAS,WAAW;AACpD,uLAAC,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC;IACxB,eACI;IACJ,SACI;IACJ,WACI;AACR;AAEe,SAAS,eAAe,EACnC,UAAU,EACV,UAAU,EACV,QAAQ,EACR,OAAO,EACH;;;IACJ,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iMAAQ,EACpC,eAAe,QAAQ,eAAe,OAChC;QAAC;QAAY;KAAW,GACxB;IAGV,SAAS;;QACL,IAAA,2LAAY,EAAC;YACT,OAAM,CAAC;gBACH,MAAM,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM;gBAC7B,YAAY;oBAAC;oBAAK;iBAAI;YAC1B;QACJ;QAEA,OAAO,yBAAW,qNAAC,sLAAM;YAAC,UAAU;;;;;mBAAe;IACvD;QATS;;YACL,2LAAY;;;IAUhB,SAAS,cAAc,EACnB,QAAQ,EAGX;;QACG,MAAM,MAAM,IAAA,2LAAY,EAAC,CAAC;QAE1B,IAAA,kMAAS;sDAAC;gBACN,MAAM,WAAW,IAAI,uNAAqB;gBAE1C,MAAM,gBAAgB,IAAK,kNAAgB,CAAS;oBAChD;oBACA,OAAO;oBACP,YAAY;oBACZ,WAAW;oBACX,iBAAiB;oBACjB,aAAa;gBACjB;gBAEA,IAAI,UAAU,CAAC;gBAEf,IAAI,EAAE,CAAC;8DAA0B,CAAC;wBAC9B,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,OAAO,QAAQ,EAAE,WAAW;wBAC7C,SAAS,GAAG;wBACZ,IAAI,OAAO,CAAC;4BAAC;4BAAG;yBAAE,EAAE;oBACxB;;gBAEA;8DAAO;wBACH,IAAI,aAAa,CAAC;oBACtB;;YACJ;qDAAG;YAAC;YAAK;SAAS;QAElB,OAAO;IACX;QAjCS;;YAKO,2LAAY;;;IA8B5B,qBACI,qNAAC;QAAI,WAAU;kBACX,cAAA,qNAAC;YAAI,WAAU;;8BACX,qNAAC;oBAAI,WAAU;;sCACX,qNAAC;4BAAG,WAAU;sCAAY;;;;;;sCAC1B,qNAAC;4BAAO,SAAS;4BAAS,WAAU;sCAAwB;;;;;;;;;;;;8BAKhE,qNAAC,kMAAY;oBACT,QAAQ,YAAY;wBAAC;wBAAS;qBAAQ;oBACtC,MAAM,WAAW,KAAK;oBACtB,OAAO;wBAAE,QAAQ;wBAAS,OAAO;oBAAO;;sCAExC,qNAAC,4LAAS;4BACN,KAAI;;;;;;sCAIR,qNAAC;4BACG,UAAU,CAAC,KAAK;gCACZ,YAAY;oCAAC;oCAAK;iCAAI;4BAC1B;;;;;;sCAIJ,qNAAC;;;;;;;;;;;8BAGL,qNAAC;oBAAI,WAAU;;sCACX,qNAAC;4BACG,SAAS;4BACT,WAAU;sCACb;;;;;;sCAGD,qNAAC;4BACG,UAAU,CAAC;4BACX,SAAS;gCACL,IAAI,UAAU,SAAS,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,EAAE;4BACnD;4BACA,WAAU;sCACb;;;;;;;;;;;;;;;;;;;;;;;AAOrB;GA5GwB;KAAA"}}]
}